@using TdA25_Error_Makers
@using TdA25_Error_Makers.Classes
@using TdA25_Error_Makers.Classes.Objects
@{
    var webTheme = Utilities.WebTheme.Get();


    // části stránky
    var background = Html.PartialAsync("/Views/Components/BlurBackground.cshtml");
    var header = Html.PartialAsync("/Views/Components/Header.cshtml");
    var footer = Html.PartialAsync("/Views/Components/Footer.cshtml");
}
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Hry • Think Different Academy</title>
    <link rel="icon" href="/favicon.ico">

    <script src="/libs/vue@(Program.DEVELOPMENT_MODE ? "_dev" : "").js"></script>
    <link rel="stylesheet" href="/libs/purecss.css">
    <link rel="stylesheet" href="/css/mainstyles.css">
    <link rel="stylesheet" href="/css/games.css">
    <link rel="stylesheet" href="@Utilities.WebTheme.GetCSSFile()">

    @*  scripty pro komponenty *@
    <script src="/scripts/components/header.js"></script>
</head>
<body id="GAMES-PAGE">
    <div id="app">
        @await background
        @await header


        <div class="sections">
            <section class="mainsection">
                <div class="texts">
                    <h1>Piškvorky</h1>

                    <div class="inputs">
                        <input style="width: 270px" type="text" placeholder="Najít..." v-model="filterName" v-on:input="updateFilters">
                        <button class="button-primary-col-sec">Vytvořit</button>
                        
                        <div class="filter-container">
                            <label for="difficulty-filter">Filtrovat dle obtížnosti</label>
                            <select id="difficulty-filter" v-model="filterDifficulty" v-on:change="updateFilters">
                                <option value="" selected>Všechny</option>
                                <option value="beginner">Začátečník</option>
                                <option value="easy">Lehká</option>
                                <option value="medium">Střední</option>
                                <option value="hard">Těžká</option>
                                <option value="extreme">Extrémně těžká</option>
                            </select>
                            
                            <select id="date-filter" v-model="selectedDateRange" v-on:change="setDateRange(selectedDateRange)">
                                <option value="" selected>Kdykoliv</option>
                                <option value="today">Dnes</option>
                                <option value="last7days">Posledních 7 dní</option>
                                <option value="last30days">Posledních 30 dní</option>
                                <option value="lastYear">Poslední rok</option>
                                <option value="custom">Vlastní</option>
                            </select>
                            
                            <div v-cloak v-if="selectedDateRange === 'custom'">
                                <input type="date" v-model="filterStartDate" v-on:change="updateFilters" placeholder="Datum od"/>
                                <input type="date" v-model="filterEndDate" v-on:change="updateFilters" placeholder="Datum do"/>
                            </div>
                        </div>
                        
                    </div>
                </div>

                <div class="content">
                    <div class="loadingdiv" v-if="games === null">
                        <div class="img"></div>
                        <h1>Načítání všech her</h1>
                    </div>

                    <div v-if="games !== null" class="games-parent">
                        <div class="child" v-for="game in gamesFiltered" v-cloak>
                            <div class="icon">

                                <!-- Když vyhrál nebo je na tahu X -->
                                <template v-if="(game.winner && game.winner === 'X') || (!game.winner && game.currentPlayer?.toUpperCase() === 'X')">
                                    <div class="x" style="mask-image: url(/images/icons/X_bile.svg)"></div>
                                    <div class="o" style="mask-image: url(/images/icons/O_bile.svg)"></div>
                                </template>

                                <template v-else>
                                    <div class="o" style="mask-image: url(/images/icons/O_bile.svg)"></div>
                                    <div class="x" style="mask-image: url(/images/icons/X_bile.svg)"></div>
                                </template>
                            </div>

                            <div class="texts"> @* display flex, flex-direction column *@
                                <h2>{{ game.name }}</h2>

                                <div class="flex">
                                    <div class="pair pair-difficulty" title="Obtížnost">
                                        <div class="icon" v-bind:style="setDifficultyIconStyle(game)"></div>
                                        <p>{{ setGameDifficultyText(game) }}</p>
                                    </div>

                                    <div class="pair pair-updateat" title="Poslední úprava">
                                        <div class="icon" style="mask-image: url(/images/icons/update.svg)"></div>
                                        <p>{{ howLongSinceLastUpdate(game) }}</p>
                                    </div>

                                    <div class="pair pair-gamestate" title="Fáze hry">
                                        <div class="icon" style="mask-image: url(/images/icons/gamestate.svg)"></div>
                                        <p>{{ setGameStateText(game) }}</p>
                                    </div>
                                </div>

                                <div class="buttons">
                                    <a class="button-primary" v-bind:href="'/game/'+ game.uuid">HRÁT</a>
                                    @* <a class="button-primary-col-sec">SMAZAT</a> *@
                                    <a class="button-secondary">UPRAVIT</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>


        @await footer
    </div>
</body>
<script type="module">
    import * as f from "/scripts/functions.js?ver=@Program.ENV.GetValueOrNull("CACHE_VERSION")";
    import { vue } from "/scripts/games.js?ver=@Program.ENV.GetValueOrNull("CACHE_VERSION")";

    window.addCookie = f.addCookie;
    //console.warn(vue);
    if (window.history.replaceState) window.history.replaceState( null, null, window.location.href );
</script>
</html>